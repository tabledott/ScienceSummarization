lobal factors.
    Our main trick is to work backwards from marginal beliefs.
    Let F be a factor and V be one of its neighboring variables.
    At any time, F has a marginal belief about V (see footnote 9), A s.t.
    A[V]=v a sum over (6)&#8217;s products of incoming messages.
    By the definition of rF&#8594;V in (4), and distributivity, we can also express the marginal belief (7) as a pointwise product of outgoing and incoming messages15 up to a constant.
    If we can quickly sum up the marginal belief (7), then (8) says we can divide out each particular incoming message q&#65533;&#65533;) V &#8594;F to obtain its corresponding outgoing message r&#65533;&#65533;&#65533;1) 14We may ignore the cost of propagators at the variables.
    Each outgoing message from a variable can be computed in time proportional to its size, which may be amortized against the cost of generating the corresponding incoming message.
    15E.g., the familiar product of forward and backward messages that is used to extract poste