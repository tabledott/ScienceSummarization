   This constraint is easily solved using any topological sort algorithm.
    A topological sort is applied once at the beginning.
    The result of the sorting does not affect the cost and the result of estimation.
    In our implementation, we assume that conjunctive/disjunctive nodes are already ordered from the root node in input data.
    The complexity of this algorithm is O(( &#732;|C |+&#732;|D|) &#732;|F||E|), where &#732;|C |and &#732;|D |are the average numbers of conjunctive and disjunctive nodes, respectively.
    This is tractable when &#732;|C |and &#732;|D |are of a reasonable size.
    As noted in this section, the number of nodes in a feature forest is usually polynomial even when that of the unpacked trees is exponential.
    Thus we can efficiently compute model expectations with polynomial computational complexity.
  
  
    Following previous studies on probabilistic models for HPSG (Oepen, Toutanova, et al. 2002; Toutanova and Manning 2002; Baldridge and Osborne 2003; Malouf and van Noo