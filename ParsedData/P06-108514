l the same boundaries except at the one position under consideration, where h2 has a boundary and h1 does not.
    The structures are shown in Figure 2.
    In order to sample a hypothesis, we need only calculate the relative probabilities of h1 and h2.
    Since h1 and h2 are the same except for a few rules, this is straightforward.
    Let h&#8722; be all of the structure shared by the two hypotheses, including n&#8722; words, and let d be the observed data.
    Then where the second line follows from Equation 3 and the properties of the CRP (in particular, that it is exchangeable, with the probability of a seating configuration not depending on the order in which customers arrive (Aldous, 1985)).
    Also, where nr is the number of branching rules r = U &#8212;* W U in h&#8722;, and I(.) is an indicator function taking on the value 1 when its argument is true, and 0 otherwise.
    The nr term is derived by integrating over all possible values of pg, and noting that the total number of U productions in h&#8