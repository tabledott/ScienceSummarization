hen this continuation can be represented as a line g, and since f~ has been discarded from the envelope, the path associated with g must also be a valid continuation for the line segments f1, ..., fN that constitute the envelope.
    Thus it follows that maxpfig, ..., fNgq~maxpf1, ..., fNqg &lt; ~fg for some -yR.
    This, however, is in contra~ diction with the premise that for all -y c R. To keep track of the phrase expansions when propagating an envelope over an outgoing arc e c tailp (vq), the phrase label &#981;v hwdp(E) has to be appended from the right to all partial translation hypotheses in the envelope.
    The complete algorithm then works as follows: First, all nodes in the phrase lattice are sorted in topological order.
    Starting with the source node, we combine for each node v the upper envelopes that are associated with v&#8217;s incoming arcs by merging their respective line arrays and reducing the merged array into a combined upper envelope using Algorithm 1.
    The combined envelope is t